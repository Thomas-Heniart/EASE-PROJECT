function checkIsConnected(e,t,o,i){function n(){var d=$(e.detail[e.bigStep].website.checkAlreadyLogged[i].search);d.length>0?checkIsConnected(e,t,o,i+1):setTimeout(function(){c++,c>100?o():n()},l)}if(i>=$(e.detail[e.bigStep].website.checkAlreadyLogged).length)t();else if(void 0==e.detail[e.bigStep].website.checkAlreadyLogged[i].action){var d=$(e.detail[e.bigStep].website.checkAlreadyLogged[i].search),g=e.detail[e.bigStep].website.checkAlreadyLogged[i].type;"absent"==g&&d.length>0?o():"absent"!=g&&d.length<=0?o():checkIsConnected(e,t,o,i+1)}else if("waitfor"==e.detail[e.bigStep].website.checkAlreadyLogged[i].action){var l=e.detail[e.bigStep].website.checkAlreadyLogged[i].time;l||(l=100);var c=0;n()}else if("search"==e.detail[e.bigStep].website.checkAlreadyLogged[i].action){var a=e.detail[e.bigStep].website.checkAlreadyLogged[i],r=$(a.search);alert("Found: "+r.length+" search: "+a.search),checkIsConnected(e,t,o,i+1)}else o()}function isConnected(e){var t=$(e.detail[e.bigStep].website.checkAlreadyLogged[0].search);return 0==t.length?!1:!0}function getNewLogin(e,t){return e.detail[t].user?{user:e.detail[t].user.login,password:e.detail[t].user.password}:e.detail[t].logWith?{user:getNewLogin(e,t-1).user,logWith:getHost(e.detail[t-1].website.loginUrl)}:void 0}function alreadyVisited(e){var t=e.lastConnections[getHost(e.detail[e.bigStep].website.loginUrl)];if(t){var o=getNewLogin(e,e.bigStep);if(o.logWith){if(o.user==t.user&&o.logWith==t.logWith)return!0}else if(t.user){if(t.user==getNewLogin(e,e.bigStep).user)return!0}else if(t==getNewLogin(e,e.bigStep).user)return!0}return!1}window.top===window&&extension.runtime.onMessage("goooo",function(e,t){"checkAlreadyLogged"==e.todo?(checkConnectionOverlay(e),checkIsConnected(e,function(){1==alreadyVisited(e)?(e.todo="connect",e.actionStep=e.detail[e.bigStep].website[e.todo].todo.length,e.type="completed",t(e)):(e.waitreload=!0,e.todo="logout",doThings(e,t),logoutOverlay(e))},function(){e.waitreload=!0,e.todo="undefined"==typeof e.detail[e.bigStep].logWith?"connect":e.detail[e.bigStep].logWith,doThings(e,t),"logout"==e.todo?logoutOverlay(e):"connect"==e.todo&&loginOverlay(e)},0)):"end"==e.todo?(endOverlay(),e.type="completed",t(e)):"nextBigStep"==e.todo?(e.type="completed",t(e)):(doThings(e,t),"logout"==e.todo?logoutOverlay(e):"connect"==e.todo&&loginOverlay(e))});