function logOutFrom(e,t){var o={};o.detail=[],o.detail.push({}),o.detail[0].website=e,o.todo="logout",o.bigStep=0,o.actionStep=0,extension.currentWindow(function(n){o.detail[0].website.logout.url&&(o.detail[0].website.home=o.detail[0].website.logout.url),extension.tabs.create(n,o.detail[0].website.home,!1,function(n){extension.tabs.onUpdated(n,function(e){n=e,extension.tabs.inject(n,["tools/extensionLight.js","overlay/injectOverlay.js","overlay/overlay.css"],function(){})}),extension.tabs.onMessage(n,"reloaded",function(){console.log("-- Page reloaded --"),extension.tabs.inject(n,["tools/extension.js","jquery-3.1.0.js","contentScripts/actions.js","contentScripts/logout.js"],function(){extension.tabs.sendMessage(n,"logout",o,function(s){console.log("-- Status : "+s.type+" --"),s&&("completed"==s.type?(o.actionStep=s.actionStep,o.actionStep<o.detail[0].website.logout.todo.length||(console.log("-- Log out done for website "+e.name+" --"),extension.tabs.onUpdatedRemoveListener(n),extension.tabs.onMessageRemoveListener(n),extension.tabs.sendMessage(t,"logoutDone",{siteId:e.siteId,siteSrc:e.siteSrc,status:"success"},function(){}),setTimeout(function(){extension.tabs.close(n,function(){})},1e3))):(console.log("-- Log out fail --"),extension.tabs.onMessageRemoveListener(n),extension.tabs.onUpdatedRemoveListener(n),extension.tabs.close(n,function(){}),extension.tabs.sendMessage(t,"logoutDone",{siteId:e.siteId,siteSrc:e.siteSrc,status:"fail"},function(){})))})})})})})}extension.runtime.bckgrndOnMessage("Logout",function(e,t){console.log("-- Global logout --"),extension.storage.get("visitedWebsites",function(e){extension.runtime.tempBckgrndOnMessage("Disconnected",function(o,n){t=n,extension.tabs.sendMessage(t,"logoutFrom",e,function(){})});for(var o in e){var n=e[o];(void 0==n.siteId||void 0==n.siteSrc)&&(n.siteId="-1"),logOutFrom(n,t)}extension.storage.set("visitedWebsites",[])})});