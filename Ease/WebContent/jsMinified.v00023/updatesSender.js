if(0==window.location.href.indexOf("https://ease.space")||0==window.location.href.indexOf("http://51.254.207.91")){var user="anonymous",updatesToDelete={},directUpdateToDelete={};document.addEventListener("NewEaseUser",function(e){user=e.detail,"anonymous"==user&&extension.runtime.sendMessage("Disconnected",{},function(){}),extension.runtime.sendMessage("ChangeEaseUser",{user:e.detail},function(){})},!1),document.addEventListener("GetUpdates",function(e){var s=[];extension.storage.get("allConnections",function(t){updatesToDelete.anonymous=[],updatesToDelete[user]=[],e.detail.forEach(function(e){if(t.anonymous[e])for(var n in t.anonymous[e]){if(t.anonymous[e][n].logWith)var o={user:e,website:n,logWith:t[e][n].logWith};else var o={user:e,website:n,password:t[e][n].password};s.push(o),updatesToDelete.anonymous.push(o)}});for(var n in t[user])for(var o in t[user][n]){if(t[user][n][o].logWith)var u={user:n,website:o,logWith:t[n][o].logWith};else var u={user:n,website:o,password:t[n][o].password};s.push(u),updatesToDelete[user].push(u)}document.dispatchEvent(new CustomEvent("Updates",{detail:s}))})}),document.addEventListener("DeleteUpdates",function(){extension.storage.get("allConnections",function(e){if(updatesToDelete.anonymous)for(var s in updatesToDelete.anonymous)e.anonymous[s.user]&&e.anonymous[s.user][s.website]&&(delete e.anonymous[s.user][s.website],jQuery.isEmptyObject(e.anonymous[s.user])&&delete e.anonymous[s.user]);if("anonymous"!=user&&updatesToDelete[user])for(var s in updatesToDelete[user])e[user][s.user]&&e[user][s.user][s.website]&&(delete e[user][s.user][s.website],jQuery.isEmptyObject(e[user][s.user])&&delete e[user][s.user]);extension.storage.set("allConnections",e,function(){})})}),extension.runtime.onMessage("SendUpdate",function(e){directUpdateToDelete=e,document.dispatchEvent(new CustomEvent("UserUpdate",{detail:e}))}),document.addEventListener("DeleteSingleUpdate",function(){extension.storage.get("allConnections",function(e){if("anonymous"!=user&&directUpdateToDelete[user])for(var s in directUpdateToDelete[user])e[user][s.user]&&e[user][s.user][s.website]&&(delete e[user][s.user][s.website],jQuery.isEmptyObject(e[user][s.user])&&delete e[user][s.user]);extension.storage.set("allConnections",e,function(){})})})}