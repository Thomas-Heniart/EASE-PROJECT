function enterEditMode(){easeDashboard.enterEditMode(),catalog.open(),$(".MenuButtonSet").addClass("editMode")}function leaveEditMode(){easeDashboard.leaveEditMode(),catalog.close(),$(".scaleOutAnimation").removeClass("scaleOutAnimation"),$(".MenuButtonSet").removeClass("editMode")}function showConfirmDeleteAppPopup(t,e){e.preventDefault(),e.stopPropagation();for(var o=$(t).closest(".siteLinkBox"),n=($(o).find(".linkImage"),!1),i=$(".siteLinkBox"),s=0;s<i.length;s++)if(i[s].getAttribute("logWith")==o.attr("id")){n=!0;break}n?showAlertPopup("This app is used to connect to several websites. You cannot delete it.",!0):popupDeleteApp.open(o)}var ease,easeRoot=function(t){var e=this;this.rootEl=t,this.apps=[],e.rootEl.find(".SitesContainer .siteLinkBox").each(function(t,o){e.apps.push(new easeApp($(o)))}),this.mainContent=this.rootEl.find("#loggedBody"),this.mainContent&&(this.onResize=function(){e.mainContent.css("height",$(window).height()-43+"px")},this.onResize(),$(window).resize(function(){e.onResize()}),this.mainContent.find(".col-left").scroll(function(){0==$(this).scrollTop()&&easeHeader.rootEl.removeClass("scrolling")||easeHeader.rootEl.addClass("scrolling")}))};$(document).ready(function(){ease=new easeRoot($("#onComputer"))});var profileManager=function(){this.getProfileById=function(t){for(var e=0;e<profiles.length;e++)if(profiles[e].id==t)return profiles[e];return null}},profiles=[],easeProfileManager;$(document).ready(function(){$(".ProfileBox:not(.helper)").each(function(){var t=new Profile($(this));profiles.push(t)}),easeProfileManager=new profileManager,$("#enterEditMode").click(enterEditMode)});var Profile=function(t){var e=this;this.qRoot=$(t),this.parentItem=this.qRoot.closest(".item"),this.profileHeader=this.qRoot.find(".ProfileName"),this.SettingsButton=this.qRoot.find(".ProfileSettingsButton"),this.ControlPanel=this.qRoot.find(".ProfileControlPanel"),this.appContainer=this.qRoot.find(".SitesContainer"),this.isSettingsOpen=!1,this.id=this.parentItem.attr("id"),this.apps=[],this.profileHeader.on("contextmenu",function(t){t.preventDefault(),t.stopPropagation(),e.showSettings()}),this.getAppById=function(t){for(var o=0;o<e.apps.length;o++)if(e.apps[o].id==t)return e.apps[o];return null},this.simpleAddApp=function(t){t.currentProfile.simpleRemoveApp(t),t.currentProfile=e,e.apps.push(t)},this.simpleRemoveApp=function(t){e.apps.splice(e.apps.indexOf(t),1)},this.addApp=function(t){t.currentProfile=e,e.apps.push(t),e.appContainer.append(t.qRoot),easeAppsManager.addApp(t)},this.removeApp=function(t){e.apps.splice(e.apps.indexOf(t),1),easeAppsManager.removeApp(t)},this.removeAllApps=function(){for(;e.apps.length;)e.removeApp(e.apps[0]);e.apps=[]},this.qRoot.find(".siteLinkBox").each(function(t,o){e.addApp((new MyApp).initWithQRoot(o))}),this.setId=function(t){e.id=t,e.parentItem.attr("id",t),e.appContainer.attr("id",t)},this.remove=function(){profiles.splice(profiles.indexOf(e),1),e.removeAllApps(),e.parentItem.animate({height:"0","margin-bottom":"0"},300),setTimeout(function(){e.parentItem.remove()},300),profiles.length<=15&&easeDashboard.adder.qRoot.css("display",""),1==e.parentItem.parent().find(".item").length&&e.parentItem.parent().width("0px")},this.showSettings=function(){e.isSettingsOpen||(e.SettingsButton.addClass("fa-rotate-90"),e.SettingsButton.addClass("settings-show"),e.ControlPanel.css("max-height","500px"),e.isSettingsOpen=!0,profiles.forEach(function(t){t.isSettingsOpen&&t!=e&&t.hideSettings()}))},this.hideSettings=function(){e.isSettingsOpen&&(e.SettingsButton.removeClass("fa-rotate-90"),e.SettingsButton.removeClass("settings-show"),e.ControlPanel.css("max-height",""),e.isSettingsOpen=!1)},this.SettingsButton.click(function(t){t.stopPropagation(),$(".ProfileSettingsButton.settings-show").each(function(){$(this).is(e.SettingsButton)||$(this).click()}),e.isSettingsOpen?e.hideSettings():e.showSettings()}),e.appContainer.droppable({accept:".catalogApp,.updateBox",drop:function(t){t.preventDefault(),t.stopPropagation(),$(this).css("border",""),e.parentItem.css("z-index",""),e.parentItem.css("transform","scale(1)"),setTimeout(function(){e.parentItem.css("transform","")},300),easeAddAppPopup.open(currentDraggedApp,e)},over:function(t){t.preventDefault(),t.stopPropagation(),e.parentItem.css("z-index","1"),e.parentItem.css("transform","scale(1)"),e.parentItem.css("transform","scale(1.1)"),$(this).css("border","1px solid "+e.qRoot.attr("color"))},out:function(t){t.preventDefault(),t.stopPropagation(),e.parentItem.css("z-index",""),e.parentItem.css("transform","scale(1)"),setTimeout(function(){e.parentItem.css("transform","")},300),$(this).css("border","")}}),this.appContainer.sortable({animation:300,group:"sites",forceFallback:!0,filter:".siteLinkBox[move='false']",handle:".logo, .emptyAppIndicator",fallbackTolerance:1,fallbackOnBody:!0,onStart:function(t){var e=$(t.item);appDragCurrentIdHelper=e.parent().attr("id"),e.css({"pointer-events":"none",opacity:"0"}),$("body").css("cursor","move")},onEnd:function(t){var o=$(t.item);$("body").css("cursor",""),o.css({"pointer-events":"",opacity:""}),(appDragCurrentIdHelper!=o.parent().attr("id")||t.oldIndex!=t.newIndex)&&(easeProfileManager.getProfileById(o.parent().attr("id")).simpleAddApp(e.getAppById(o.attr("id"))),postHandler.post("MoveApp",{appId:o.attr("id"),profileIdDest:o.parent().attr("id"),positionDest:o.index()},function(){},function(){easeTracker.trackEvent("MoveApp")},function(){},"text"))},onMove:function(t){return"false"==$(t.dragged).attr("move")?!1:void 0}}),this.qRoot.find("#deleteProfileForm #validate").click(function(){e.appContainer.find(".siteLinkBox").length>0?easeDeleteProfilePopup.open(e):postHandler.post("RemoveProfile",{profileId:e.id},function(){},function(){easeTracker.trackEvent("DeleteProfile"),e.remove()},function(){},"text")}),this.qRoot.find("#modifyNameForm #validate").click(function(){var t=$(this).parent().find("input").val();t.length&&postHandler.post("EditProfileName",{name:t,profileId:e.id},function(){},function(){easeTracker.trackEvent("EditProfileName",{newProfileName:t}),e.setName(t),e.qRoot.find("#modifyNameForm input").val("")},function(){},"text")}),this.qRoot.find("#modifyNameForm input").keyup(function(t){13==t.which&&e.qRoot.find("#modifyNameForm #validate").click()}),this.setName=function(t){e.profileHeader.find("p").text("@"+t)},this.setColor=function(t){e.profileHeader.css("background-color",t),e.qRoot.attr("color",t)},this.qRoot.find("#modifyColorForm .color").click(function(){var t=$(this).attr("color");e.qRoot.find("#modifyColorForm .color.choosen").removeClass("choosen"),$(this).addClass("choosen"),postHandler.post("EditProfileColor",{color:t,profileId:e.id},function(){},function(){easeTracker.trackEvent("EditProfileColor",{newProfileColor:t}),e.setColor(t)},function(){},"text")})};$(document).click(function(t){var e=$(t.target).closest(".ProfileControlPanel"),o=null;e.length&&(o=e.closest(".ProfileBox").find(".ProfileSettingsButton.settings-show")),$(".ProfileSettingsButton.settings-show").each(function(){$(this).is($(o))||$(this).click()})});var appDragCurrentIdHelper=0;$(document).ready(function(){$("#PopupAddApp #password").keyup(function(t){13==t.keyCode&&$("#PopupAddApp .md-content .buttonSet #accept").click()}),$("#PopupAddApp #login").keyup(function(t){13==t.keyCode&&$("#PopupAddApp #password").focus()})}),$(document).ready(function(){$(document).click(function(t){$(".CatalogViewTab").hasClass("show")&&!$(t.target).closest(".MenuButtonSet").length&&0==$(".md-show, .popupHandler.myshow").length&&($(t.target).closest("#profileAdder, .header, .dashboardColumn, .md-modal, .md-overlay, .CatalogViewTab, .AddProfileView, .updateButton, .hiddenProfile, #tipsHandler, .updateBox, .popupHandler").length||leaveEditMode())})}),function(t){$.fn.attr=function(){if(0===arguments.length){if(0===this.length)return null;var e={};return $.each(this[0].attributes,function(){this.specified&&(e[this.name]=this.value)}),e}return t.apply(this,arguments)}}($.fn.attr);