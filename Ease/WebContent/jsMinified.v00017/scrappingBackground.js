function testOverlay(){extension.currentWindow(function(e){extension.tabs.create(e,"http://www.linkedin.com",!0,function(e){extension.tabs.onUpdated(e,function(n){e=n,extension.tabs.sendMessage(e,"scrapOverlay","Facebook",function(){})})})})}function startScrapFacebook(e,n,s){extension.currentWindow(function(t){extension.tabs.create(t,"https://www.facebook.com",!1,function(t){extension.tabs.onUpdated(t,function(e){t=e,extension.tabs.sendMessage(t,"scrapOverlay","Facebook",function(){})}),extension.tabs.onClosed(t,function(){s(!1,"It seems that you closed the tab. Please try again."),extension.tabs.onClosedRemoveListener(t),extension.tabs.onMessageRemoveListener(t),extension.tabs.onUpdatedRemoveListener(t)}),extension.tabs.onMessage(t,"scrapReloaded",function(){extension.tabs.onMessageRemoveListener(t),extension.tabs.sendMessage(t,"checkFbCo",{},function(o){1==o?logoutFromFb(t,function(t){connectToFb(t,e,n,s)}):connectToFb(t,e,n,s)})})})})}function logoutFromFb(e,n){extension.tabs.sendMessage(e,"logoutFromFb",{},function(){extension.tabs.update(e,"https://www.facebook.com",function(e){extension.tabs.onMessage(e,"scrapReloaded",function(){extension.tabs.onMessageRemoveListener(e),n(e)})})})}function connectToFb(e,n,s,t){extension.tabs.sendMessage(e,"connectToFb",{login:n,pass:s},function(){extension.tabs.onMessage(e,"scrapReloaded",function(){extension.tabs.onMessageRemoveListener(e),extension.tabs.sendMessage(e,"checkFbCo",{},function(n){0==n?(t(!1,"Wrong login or password. Please try again."),extension.tabs.onClosedRemoveListener(e),extension.tabs.onUpdatedRemoveListener(e),setTimeout(function(){extension.tabs.close(e)},500)):scrapFb(e,t)})})})}function scrapFb(e,n){extension.tabs.update(e,"https://www.facebook.com/settings?tab=applications",function(e){extension.tabs.onMessage(e,"scrapReloaded",function(){extension.tabs.onMessageRemoveListener(e),extension.tabs.sendMessage(e,"scrapFb",{},function(s){n(!0,s),extension.tabs.onClosedRemoveListener(e),extension.tabs.onUpdatedRemoveListener(e),setTimeout(function(){extension.tabs.close(e)},500)})})})}function startScrapChrome(e,n,s){extension.currentWindow(function(t){extension.tabs.create(t,"https://accounts.google.com/Logout",!1,function(t){extension.tabs.onUpdated(t,function(e){t=e,extension.tabs.sendMessage(t,"scrapOverlay","Chrome",function(){})}),extension.tabs.onClosed(t,function(){s(!1,"It seems that you closed the tab. Please try again."),extension.tabs.onClosedRemoveListener(t),extension.tabs.onMessageRemoveListener(t),extension.tabs.onUpdatedRemoveListener(t)}),extension.tabs.onMessage(t,"scrapReloaded",function(){extension.tabs.onMessageRemoveListener(t),extension.tabs.update(t,"https://accounts.google.com/ServiceLogin?sacu=1#identifier",function(t){extension.tabs.onMessage(t,"scrapReloaded",function(){extension.tabs.onMessageRemoveListener(t),extension.tabs.sendMessage(t,"connectToChrome",{login:e,pass:n},function(e){0==e?(s(!1,"Wrong login or password. Please try again"),extension.tabs.onClosedRemoveListener(t),extension.tabs.onUpdatedRemoveListener(t),setTimeout(function(){extension.tabs.close(t)},500)):extension.tabs.onMessage(t,"scrapReloaded",function(e){extension.tabs.onMessageRemoveListener(t),extension.tabs.sendMessage(t,"checkChromeCo",{},function(o){function a(e,n){0!=e.indexOf("https://myaccount.google.com")?extension.tabs.onMessage(t,"scrapReloaded",function(e){extension.tabs.onMessageRemoveListener(t),a(e.url,n)}):n()}o?a(e.url,function(){extension.tabs.update(t,"https://passwords.google.com/",function(e){extension.tabs.onMessage(e,"scrapReloaded",function(){extension.tabs.onMessageRemoveListener(e),extension.tabs.sendMessage(e,"typePasswordChrome",{pass:n},function(){}),extension.tabs.onMessage(e,"scrapReloaded",function(){extension.tabs.onMessageRemoveListener(e),extension.tabs.sendMessage(e,"scrapChrome",{},function(n){encryptAllPasswords(n,function(n){extension.tabs.onClosedRemoveListener(e),extension.tabs.onUpdatedRemoveListener(e),setTimeout(function(){extension.tabs.close(e)},500),s(!0,n)})})})})})}):(s(!1,"Wrong login or password. Please try again"),extension.tabs.onClosedRemoveListener(t),extension.tabs.onUpdatedRemoveListener(t),setTimeout(function(){extension.tabs.close(t)},500))})})})})})})})})}function startScrapLinkedin(e,n,s){extension.currentWindow(function(t){extension.tabs.create(t,"https://www.linkedin.com/psettings/third-party-applications",!1,function(t){extension.tabs.onUpdated(t,function(e){t=e,extension.tabs.sendMessage(t,"scrapOverlay","Linkedin",function(){})}),extension.tabs.onClosed(t,function(){s(!1,"It seems that you closed the tab. Please try again."),extension.tabs.onClosedRemoveListener(t),extension.tabs.onMessageRemoveListener(t),extension.tabs.onUpdatedRemoveListener(t)}),extension.tabs.onMessage(t,"scrapReloaded",function(){extension.tabs.onMessageRemoveListener(t),extension.tabs.sendMessage(t,"checkLnkdnCo",{},function(o){1==o?logoutFromLnkdn(t,function(t){connectToLnkdn(t,e,n,s)}):connectToLnkdn(t,e,n,s)})})})})}function logoutFromLnkdn(e,n){extension.tabs.sendMessage(e,"logoutFromLnkdn",{},function(){}),extension.tabs.onMessage(e,"scrapReloaded",function(){extension.tabs.onMessageRemoveListener(e),n(e)})}function connectToLnkdn(e,n,s,t){extension.tabs.update(e,"https://www.linkedin.com/uas/login",function(e){extension.tabs.onMessage(e,"scrapReloaded",function(){extension.tabs.onMessageRemoveListener(e),extension.tabs.sendMessage(e,"connectToLnkdn",{login:n,pass:s},function(){var n=!1;setTimeout(function(){n||extension.tabs.sendMessage(e,"checkLnkdnCo",{},function(n){0==n&&(t(!1,"Wrong login or password. Please try again"),extension.tabs.onClosedRemoveListener(e),extension.tabs.onUpdatedRemoveListener(e),setTimeout(function(){extension.tabs.close(e)},500))})},1e4),extension.tabs.onMessage(e,"scrapReloaded",function(){extension.tabs.onMessageRemoveListener(e),extension.tabs.sendMessage(e,"checkLnkdnCo",{},function(n){0==n?(t(!1,"Wrong login or password. Please try again"),extension.tabs.onClosedRemoveListener(e),extension.tabs.onUpdatedRemoveListener(e),setTimeout(function(){extension.tabs.close(e)},500)):scrapLnkdn(e,t)})})})})})}function scrapLnkdn(e,n){extension.tabs.update(e,"https://www.linkedin.com/psettings/third-party-applications",function(e){extension.tabs.onMessage(e,"scrapReloaded",function(){extension.tabs.onMessageRemoveListener(e),extension.tabs.sendMessage(e,"scrapLnkdn",{},function(s){extension.tabs.onClosedRemoveListener(e),extension.tabs.onUpdatedRemoveListener(e),n(!0,s),setTimeout(function(){extension.tabs.close(e)},500)})})})}extension.runtime.bckgrndOnMessage("ScrapFacebook",function(e,n,s){startScrapFacebook(e.login,e.password,function(e,t){e&&0==t.length&&(e=!1,t="You did not connect to any website with this Facebook account. Try it with another account."),extension.tabs.focus(n,function(){}),s({success:e,msg:t})})}),extension.runtime.bckgrndOnMessage("ScrapLinkedIn",function(e,n,s){startScrapLinkedin(e.login,e.password,function(e,t){e&&0==t.length&&(e=!1,t="You did not connect to any website with this Linkedin account. Try it with another account."),extension.tabs.focus(n,function(){}),s({success:e,msg:t})})}),extension.runtime.bckgrndOnMessage("ScrapChrome",function(e,n,s){startScrapChrome(e.login,e.password,function(e,t){e&&0==t.length&&(e=!1,t="There is no password saved on this chrome account. Try it with another account."),extension.tabs.focus(n,function(){}),s({success:e,msg:t})})});