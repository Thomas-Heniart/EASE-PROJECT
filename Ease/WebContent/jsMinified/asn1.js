!function(t){"use strict";function e(t,r){t instanceof e?(this.enc=t.enc,this.pos=t.pos):(this.enc=t,this.pos=r)}function r(t,e,r,s,n){this.stream=t,this.header=e,this.length=r,this.tag=s,this.sub=n}var s=100,n="â€¦",i={tag:function(t,e){var r=document.createElement(t);return r.className=e,r},text:function(t){return document.createTextNode(t)}};e.prototype.get=function(e){if(e===t&&(e=this.pos++),e>=this.enc.length)throw"Requesting byte offset "+e+" on a stream of length "+this.enc.length;return this.enc[e]},e.prototype.hexDigits="0123456789ABCDEF",e.prototype.hexByte=function(t){return this.hexDigits.charAt(t>>4&15)+this.hexDigits.charAt(15&t)},e.prototype.hexDump=function(t,e,r){for(var s="",n=t;e>n;++n)if(s+=this.hexByte(this.get(n)),r!==!0)switch(15&n){case 7:s+="  ";break;case 15:s+="\n";break;default:s+=" "}return s},e.prototype.parseStringISO=function(t,e){for(var r="",s=t;e>s;++s)r+=String.fromCharCode(this.get(s));return r},e.prototype.parseStringUTF=function(t,e){for(var r="",s=t;e>s;){var n=this.get(s++);r+=String.fromCharCode(128>n?n:n>191&&224>n?(31&n)<<6|63&this.get(s++):(15&n)<<12|(63&this.get(s++))<<6|63&this.get(s++))}return r},e.prototype.parseStringBMP=function(t,e){for(var r="",s=t;e>s;s+=2){var n=this.get(s),i=this.get(s+1);r+=String.fromCharCode((n<<8)+i)}return r},e.prototype.reTime=/^((?:1[89]|2\d)?\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,e.prototype.parseTime=function(t,e){var r=this.parseStringISO(t,e),s=this.reTime.exec(r);return s?(r=s[1]+"-"+s[2]+"-"+s[3]+" "+s[4],s[5]&&(r+=":"+s[5],s[6]&&(r+=":"+s[6],s[7]&&(r+="."+s[7]))),s[8]&&(r+=" UTC","Z"!=s[8]&&(r+=s[8],s[9]&&(r+=":"+s[9]))),r):"Unrecognized time: "+r},e.prototype.parseInteger=function(t,e){var r=e-t;if(r>4){r<<=3;var s=this.get(t);if(0===s)r-=8;else for(;128>s;)s<<=1,--r;return"("+r+" bit)"}for(var n=0,i=t;e>i;++i)n=n<<8|this.get(i);return n},e.prototype.parseBitString=function(t,e){var r=this.get(t),s=(e-t-1<<3)-r,n="("+s+" bit)";if(20>=s){var i=r;n+=" ";for(var a=e-1;a>t;--a){for(var o=this.get(a),h=i;8>h;++h)n+=o>>h&1?"1":"0";i=0}}return n},e.prototype.parseOctetString=function(t,e){var r=e-t,i="("+r+" byte) ";r>s&&(e=t+s);for(var a=t;e>a;++a)i+=this.hexByte(this.get(a));return r>s&&(i+=n),i},e.prototype.parseOID=function(t,e){for(var r="",s=0,n=0,i=t;e>i;++i){var a=this.get(i);if(s=s<<7|127&a,n+=7,!(128&a)){if(""===r){var o=80>s?40>s?0:1:2;r=o+"."+(s-40*o)}else r+="."+(n>=31?"bigint":s);s=n=0}}return r},r.prototype.typeName=function(){if(this.tag===t)return"unknown";var e=this.tag>>6,r=(this.tag>>5&1,31&this.tag);switch(e){case 0:switch(r){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString";default:return"Universal_"+r.toString(16)}case 1:return"Application_"+r.toString(16);case 2:return"["+r+"]";case 3:return"Private_"+r.toString(16)}},r.prototype.reSeemsASCII=/^[ -~]+$/,r.prototype.content=function(){if(this.tag===t)return null;var e=this.tag>>6,r=31&this.tag,i=this.posContent(),a=Math.abs(this.length);if(0!==e){if(null!==this.sub)return"("+this.sub.length+" elem)";var o=this.stream.parseStringISO(i,i+Math.min(a,s));return this.reSeemsASCII.test(o)?o.substring(0,2*s)+(o.length>2*s?n:""):this.stream.parseOctetString(i,i+a)}switch(r){case 1:return 0===this.stream.get(i)?"false":"true";case 2:return this.stream.parseInteger(i,i+a);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(i,i+a);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(i,i+a);case 6:return this.stream.parseOID(i,i+a);case 16:case 17:return"("+this.sub.length+" elem)";case 12:return this.stream.parseStringUTF(i,i+a);case 18:case 19:case 20:case 21:case 22:case 26:return this.stream.parseStringISO(i,i+a);case 30:return this.stream.parseStringBMP(i,i+a);case 23:case 24:return this.stream.parseTime(i,i+a)}return null},r.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},r.prototype.print=function(e){if(e===t&&(e=""),document.writeln(e+this),null!==this.sub){e+="  ";for(var r=0,s=this.sub.length;s>r;++r)this.sub[r].print(e)}},r.prototype.toPrettyString=function(e){e===t&&(e="");var r=e+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(r+="+"),r+=this.length,32&this.tag?r+=" (constructed)":3!=this.tag&&4!=this.tag||null===this.sub||(r+=" (encapsulates)"),r+="\n",null!==this.sub){e+="  ";for(var s=0,n=this.sub.length;n>s;++s)r+=this.sub[s].toPrettyString(e)}return r},r.prototype.toDOM=function(){var t=i.tag("div","node");t.asn1=this;var e=i.tag("div","head"),r=this.typeName().replace(/_/g," ");e.innerHTML=r;var s=this.content();if(null!==s){s=String(s).replace(/</g,"&lt;");var n=i.tag("span","preview");n.appendChild(i.text(s)),e.appendChild(n)}t.appendChild(e),this.node=t,this.head=e;var a=i.tag("div","value");if(r="Offset: "+this.stream.pos+"<br/>",r+="Length: "+this.header+"+",r+=this.length>=0?this.length:-this.length+" (undefined)",32&this.tag?r+="<br/>(constructed)":3!=this.tag&&4!=this.tag||null===this.sub||(r+="<br/>(encapsulates)"),null!==s&&(r+="<br/>Value:<br/><b>"+s+"</b>","object"==typeof oids&&6==this.tag)){var o=oids[s];o&&(o.d&&(r+="<br/>"+o.d),o.c&&(r+="<br/>"+o.c),o.w&&(r+="<br/>(warning!)"))}a.innerHTML=r,t.appendChild(a);var h=i.tag("div","sub");if(null!==this.sub)for(var u=0,c=this.sub.length;c>u;++u)h.appendChild(this.sub[u].toDOM());return t.appendChild(h),e.onclick=function(){t.className="node collapsed"==t.className?"node":"node collapsed"},t},r.prototype.posStart=function(){return this.stream.pos},r.prototype.posContent=function(){return this.stream.pos+this.header},r.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},r.prototype.fakeHover=function(t){this.node.className+=" hover",t&&(this.head.className+=" hover")},r.prototype.fakeOut=function(t){var e=/ ?hover/;this.node.className=this.node.className.replace(e,""),t&&(this.head.className=this.head.className.replace(e,""))},r.prototype.toHexDOM_sub=function(t,e,r,s,n){if(!(s>=n)){var a=i.tag("span",e);a.appendChild(i.text(r.hexDump(s,n))),t.appendChild(a)}},r.prototype.toHexDOM=function(e){var r=i.tag("span","hex");if(e===t&&(e=r),this.head.hexNode=r,this.head.onmouseover=function(){this.hexNode.className="hexCurrent"},this.head.onmouseout=function(){this.hexNode.className="hex"},r.asn1=this,r.onmouseover=function(){var t=!e.selected;t&&(e.selected=this.asn1,this.className="hexCurrent"),this.asn1.fakeHover(t)},r.onmouseout=function(){var t=e.selected==this.asn1;this.asn1.fakeOut(t),t&&(e.selected=null,this.className="hex")},this.toHexDOM_sub(r,"tag",this.stream,this.posStart(),this.posStart()+1),this.toHexDOM_sub(r,this.length>=0?"dlen":"ulen",this.stream,this.posStart()+1,this.posContent()),null===this.sub)r.appendChild(i.text(this.stream.hexDump(this.posContent(),this.posEnd())));else if(this.sub.length>0){var s=this.sub[0],n=this.sub[this.sub.length-1];this.toHexDOM_sub(r,"intro",this.stream,this.posContent(),s.posStart());for(var a=0,o=this.sub.length;o>a;++a)r.appendChild(this.sub[a].toHexDOM(e));this.toHexDOM_sub(r,"outro",this.stream,n.posEnd(),this.posEnd())}return r},r.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},r.decodeLength=function(t){var e=t.get(),r=127&e;if(r==e)return r;if(r>3)throw"Length over 24 bits not supported at position "+(t.pos-1);if(0===r)return-1;e=0;for(var s=0;r>s;++s)e=e<<8|t.get();return e},r.hasContent=function(t,s,n){if(32&t)return!0;if(3>t||t>4)return!1;var i=new e(n);3==t&&i.get();var a=i.get();if(a>>6&1)return!1;try{var o=r.decodeLength(i);return i.pos-n.pos+o==s}catch(h){return!1}},r.decode=function(t){t instanceof e||(t=new e(t,0));var s=new e(t),n=t.get(),i=r.decodeLength(t),a=t.pos-s.pos,o=null;if(r.hasContent(n,i,t)){var h=t.pos;if(3==n&&t.get(),o=[],i>=0){for(var u=h+i;t.pos<u;)o[o.length]=r.decode(t);if(t.pos!=u)throw"Content size is not correct for container starting at offset "+h}else try{for(;;){var c=r.decode(t);if(0===c.tag)break;o[o.length]=c}i=h-t.pos}catch(p){throw"Exception while decoding undefined length content: "+p}}else t.pos+=i;return new r(s,a,i,n,o)},r.test=function(){for(var t=[{value:[39],expected:39},{value:[129,201],expected:201},{value:[131,254,220,186],expected:16702650}],s=0,n=t.length;n>s;++s){var i=new e(t[s].value,0),a=r.decodeLength(i);a!=t[s].expected&&document.write("In test["+s+"] expected "+t[s].expected+" got "+a+"\n")}},window.ASN1=r}();