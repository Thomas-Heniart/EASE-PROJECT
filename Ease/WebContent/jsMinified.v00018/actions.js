function fire_onchange(t){var e=t.ownerDocument.createEvent("Events");e.initEvent("change",!0,!0),t.dispatchEvent(e),e=t.ownerDocument.createEvent("Events"),e.initEvent("input",!0,!0),t.dispatchEvent(e)}function doThings(t,e){var o=t.detail[t.bigStep].website[t.todo].todo;return t.actionStep>=o.length?(t.type="completed",e(t),void("logout"==t.todo&&(t.todo="connect",t.actionStep=0,actions[o[t.actionStep].action](t,doThings,e)))):(console.log("-- Ease action : "+o[t.actionStep].action+" --"),void actions[o[t.actionStep].action](t,doThings,e))}function getHost(t){var e=function(t){var e=document.createElement("a");return e.href=t,e};return e(t).hostname}var waited=!1,actions={fillThenSubmit:function(t,e,o){var i=t.detail[t.bigStep].website[t.todo].todo[t.actionStep],n=$(i.login),a=$(i.password);0==n.length?1==i.grave?(t.type="error: "+i.what+" input not found",o(t),errorOverlay(t)):(t.actionStep++,e(t,o)):(n.click(),n.val(t.detail[0].user.login),n.blur(),a.click(),a.val(t.detail[0].user.password),a.blur(),$("body").append("<script type='text/javascript'>$('"+i.login+"').change(); $('"+i.password+"').change();</script>"),$(i.submit).click(),t.actionStep++,e(t,o))},erasecookies:function(t,e,o){function i(t){var e=document.domain,o="/";document.cookie=t+"=; expires="+ +new Date+"; domain="+e+"; path="+o}var n=t.detail[t.bigStep].website[t.todo].todo[t.actionStep].search;if(n)i(n);else for(var a=document.cookie.split(";"),r=0;r<a.length;r++){var c=a[r],d=c.indexOf("="),n=d>-1?c.substr(0,d):c;i(n)}t.actionStep++,e(t,o)},waitfor:function(t,e,o){function i(e){"string"==typeof n&&(n=[n]);var c=!0;for(var d in n){var p=$(n[d]);if(p.length>0){c=!1;break}}r%20==0&&console.log("-- waiting for element "+n[0]+" --"),r>100?(t.type="error: connection too long",o(t),errorOverlay(t)):c?setTimeout(function(){r++,i(e)},a):(t.actionStep++,e(t,o))}var n=t.detail[t.bigStep].website[t.todo].todo[t.actionStep].search,a=t.detail[t.bigStep].website[t.todo].todo[t.actionStep].time;a||(a=100);var r=0;i(e)},setattr:function(t,e,o){var i=t.detail[t.bigStep].website[t.todo].todo[t.actionStep],n=$(i.search);0==n.length?1==i.grave?(t.type="error: element not found",o(t),errorOverlay(t)):(t.actionStep++,e(t,o)):(n.attr(i.attr,i.content),t.actionStep++,e(t,o))},simulateKeyPress:function(t,e,o){var i=t.detail[t.bigStep].website[t.todo].todo[t.actionStep],n=$(i.search);if(0==n.length)1==i.grave?(t.type="error: "+i.what+" input not found",o(t),errorOverlay(t)):(t.actionStep++,e(t,o));else{n.click(),n.focus();var a=jQuery.Event("keydown");a.which=i.keyCode,a.keyCode=i.keyCode,n.trigger(a),a=jQuery.Event("keypress"),a.which=i.keyCode,a.keyCode=i.keyCode,n.trigger(a),n.val(n.val()+String.fromCharCode(a.which)),a=jQuery.Event("keyup"),a.which=i.keyCode,a.keyCode=i.keyCode,n.trigger(a),t.actionStep++,e(t,o)}},fill:function(t,e,o){var i=t.detail[t.bigStep].website[t.todo].todo[t.actionStep],n=$(i.search);if(0==n.length)1==i.grave?(t.type="error: "+i.what+" input not found",o(t),errorOverlay(t)):(t.actionStep++,e(t,o));else{if(waited)var a=1;else var a=500;setTimeout(function(){n.select(),n.click(),n[0].focus(),n[0].value=t.detail[0].user[i.what],fire_onchange(n[0]),n[0].blur(),t.actionStep++,e(t,o)},a)}},val:function(t,e,o){var i=t.detail[t.bigStep].website[t.todo].todo[t.actionStep],n=$(i.search);if(0==n.length)1==i.grave?(t.type="error: "+i.what+" input not found",o(t),errorOverlay(t)):(t.actionStep++,e(t,o));else{if(waited)var a=1;else var a=500;setTimeout(function(){n.val(t.detail[0].user[i.what]),waited=!0,t.actionStep++,e(t,o)},a)}},checkIfPopup:function(t,e,o){t.actionStep++,e(t,o)},click:function(t,e,o){var i=t.detail[t.bigStep].website[t.todo].todo[t.actionStep],n=$(i.search);0==n.length?1==i.grave?(t.type="error: button not found",o(t),errorOverlay(t)):(t.actionStep++,e(t,o)):(n.prop("disabled",!1),window.setTimeout(function(){n.click()},250),t.actionStep++,e(t,o))},clickona:function(t,e,o){var i=t.detail[t.bigStep].website[t.todo].todo[t.actionStep],n=$(i.search);0==n.length?1==i.grave?(t.type="error: button not found",o(t),errorOverlay(t)):(t.actionStep++,e(t,o)):(n.prop("disabled",!1),n.get(0).click(),n.click(),t.actionStep++,e(t,o))},aclick:function(t,e,o){var i=t.detail[t.bigStep].website[t.todo].todo[t.actionStep],n=$(i.search);0==n.length?1==i.grave?(t.type="error: link not found",o(t),errorOverlay(t)):(t.actionStep++,e(t,o)):(window.location.href=n.attr("href"),t.actionStep++,t.type="completed",o(t))},submit:function(t,e,o){var i=t.detail[t.bigStep].website[t.todo].todo[t.actionStep],n=$(i.search);0==n.length?1==i.grave?(t.type="error: connection form not found",o(t),errorOverlay(t)):(t.actionStep++,e(t,o)):(n.submit(),t.actionStep++,e(t,o))},wait:function(t,e,o){setTimeout(function(){t.actionStep++,e(t,o)},t.detail[t.bigStep].website[t.todo].todo[t.actionStep].timeout)},waitload:function(t,e,o){t.actionStep++,t.type="completed",o(t)},search:function(t,e,o){var i=t.detail[t.bigStep].website[t.todo].todo[t.actionStep],n=$(i.search);alert("Found: "+n.length+" search: "+i.search),t.actionStep++,e(t,o)},"goto":function(t,e,o){var i,n=t.detail[t.bigStep].website[t.todo].todo[t.actionStep];i="object"==typeof n.url?n.url.http+t.detail[0].user[n.url.subdomain]+"."+n.url.domain:n.url,void 0!=i&&(window.location.href=i),t.actionStep++,t.type="completed",o(t)},enterFrame:function(t,e,o){var i=t.detail[t.bigStep].website[t.todo].todo[t.actionStep];$(i.search).length?(t.frameUrl=$(i.search)[0].src,extension.runtime.sendMessage("sendToChildFrame",t,function(i){t=i,t.actionStep++,e(t,o)})):(t.actionStep++,e(t,o))},exitFrame:function(t,e,o){if(window.top===window)t.actionStep++,e(t,o);else{{t.detail[t.bigStep].website[t.todo].todo[t.actionStep]}o(t)}}};window.top===window||(extension.runtime.onMessage("toChildFrame",function(t,e){t.detail[t.bigStep].website[t.todo].todo[t.actionStep];window.location.href==t.frameUrl&&(t.actionStep++,doThings(t,e))}),extension.runtime.sendMessage("haveFrames",window.location.href,function(){}));